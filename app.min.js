!function(t,e,n,i){function o(){}o.initialize=function(){e.initialLoad=function(t){ContentManager.addImage("logo","logo.png"),ContentManager.addImage("rotate_device_to_landscape","initial/rotate_device_to_landscape.png"),ContentManager.addImage("rotate_device_to_portrait","initial/rotate_device_to_portrait.png"),ContentManager.downloadResources(function(){var n=new LoadingScreen;e.navigator.add(n,1),t&&t.call(e),t=null},e)},e.layoutCanvas=function(){document.body.appendChild(e.pixi.view),Config.window_mode!==Config.MODE_NONE&&(e.pixi.view.style.width=e.canvasWidth+"px",e.pixi.view.style.height=e.canvasHeight+"px"),Config.window_mode===Config.MODE_CENTERED?e.adjustCanvasPositionCentered(e.pixi.view):Config.window_mode===Config.MODE_PADDING&&e.adjustCanvasPositionPadding(e.pixi.view)},e.debugStage=function(t){t=t||e.stage.children;for(var n=0;n<t.length;n++){var i=t[n];e.drawItem(i,e.debugLayer),i.children&&e.debugStage(i.children)}},e.drawItem=function(t,e){var n=t.getSensor();if(n)if(n instanceof SAT.Circle){var i=n.pos;e.beginFill(0,.3),e.lineStyle(2,0),e.drawCircle(i.x,i.y,n.r),e.endFill()}else{i=n.pos;var o=n.points;e.beginFill(0),e.lineStyle(1,0),e.drawCircle(i.x,i.y,2);for(var s=0;s<o.length;s++)e.moveTo(i.x+o[s].x,i.y+o[s].y),s===o.length-1?e.lineTo(i.x+o[0].x,i.y+o[0].y):e.lineTo(i.x+o[s+1].x,i.y+o[s+1].y);e.endFill()}},e.tick=function(t){var n=e.pixi.ticker.elapsedMS;n=n>50?50:n,Actions.update(n),e.navigator.update(n),Config.debug&&(e.debugLayer.clear(),e.debugStage())},e.adjustCanvasPositionCentered=function(t){var n=e.windowWidth-e.canvasWidth,i=e.windowHeight-e.canvasHeight;t.style.marginLeft=Math.ceil(n/2)+"px",t.style.marginTop=Math.ceil(i/2)+"px"},e.adjustCanvasPositionPadding=function(t){var e=Config.canvas_padding.split(" ");t.style.marginLeft=Math.ceil(e[3])+"px",t.style.marginTop=Math.ceil(e[0])+"px"},e.handleVisibility=function(t){e.navigator.onVisibilityChange(t),t?Config.is_sound_on&&Howler.mute(!1):Howler.mute(!0)},e.resize=function(n){var i=!0;i=void 0===n?Config.is_canvas_auto_layout:n;e.windowWidth,e.windowHeight,e.windowWidth,e.windowHeight,e.windowWidth,e.windowHeight;e.device.calculateSizes(),e.device.isKeyboardTheSource||(i=!0,e.device.isKeyboardUp&&(t.scrollTo(0,0),e.navigator.blurInputs(),e.device.isKeyboardUp=!1,e.device.isKeyboardTheSource=!0)),i&&(e.pixi.view.style.width=Math.ceil(e.canvasWidth)+"px",e.pixi.view.style.height=Math.ceil(e.canvasHeight)+"px",e.pixi.renderer.resize(e.width,e.height),Config.window_mode===Config.MODE_CENTERED?e.adjustCanvasPositionCentered(e.pixi.view):Config.window_mode===Config.MODE_PADDING&&e.adjustCanvasPositionPadding(e.pixi.view)),e.input.recalucateOffset(),e.navigator.onResizeScreens(e.width,e.height),i&&e.rotate_layer&&(e.checkRotation(),e.rotate_layer.onResize()),e.device.isKeyboardTheSource=!1},e.checkRotation=function(){if(Config.window_mode===Config.MODE_CENTERED)return!1;Config.rotation_mode===Config.ROTATION_MODE_HORIZONTAL?e.windowWidth<e.windowHeight?e.showRotateDevice():e.hideRotateDevice():Config.rotation_mode===Config.ROTATION_MODE_VERTICAL&&(e.windowWidth>e.windowHeight?e.showRotateDevice():e.hideRotateDevice())},e.showRotateDevice=function(){e.isRotationLayerShown||(e.isRotationLayerShown=!0,e.stage.addChild(e.rotate_layer),e.navigator.pauseScreen(!0),e.input.isBlocked=!0,Actions.pause(),Config.is_sound_on&&Howler.mute(!0))},e.hideRotateDevice=function(){e.isRotationLayerShown&&(e.isRotationLayerShown=!1,e.rotate_layer.removeFromParent(),e.navigator.pauseScreen(!1),e.input.isBlocked=!1,Actions.resume(),Config.is_sound_on&&Howler.mute(!1))},e.width=0,e.height=0,e.canvasWidth=0,e.canvasHeight=0,e.windowWidth=0,e.windowHeight=0,e.device=new Device(e),null!==Config.window_mode_mobile&&(e.device.isMobile.phone||e.device.isMobile.tablet)&&(Config.window_mode=Config.window_mode_mobile,e.device.calculateSizes());var n=document.createElement("canvas");e.input=new Input(e,n);var i={resolution:1,width:e.width,height:e.height,transparent:!1,view:n,antialias:!1,forceCanvas:!1};e.pixi=new PIXI.Application(i),e.pixi.ticker.add(e.tick,e),e.stage=e.pixi.stage,e.loader=PIXI.Loader.shared,e.navigator=new HNavigator(e),e.initialLoad(function(){e.layoutCanvas(),e.loadAssets(),ContentManager.downloadResources(function(){if(t._loadingBar){if(_loadingBar.setPercent(1,!1),!t[Config.initialScreen])throw Config.initialScreen+" - is not Defined";var n=applyToConstructor(t[Config.initialScreen],Config.initialScreenArgs);timeout(function(){e.navigator.popAndGo(n)},60),Config.rotation_mode&&(e.rotate_layer=new RotateLayer),e.checkRotation()}},e)}),Config.debug&&(e.debugLayer=new PIXI.Graphics,e.debugLayer.zIndex=100,e.stage.addChild(e.debugLayer)),Visibility.change(function(t,n){e.handleVisibility("visible"===n)});for(var o=1;o<15;o++)timeout(function(){e.device.isKeyboardUp||e.resize(!0)},100*o)},t.App=o,n.setChallenge=function(t){console.log("set , chll",t);var e=t[Object.keys(t)[0]];console.log(e),n.challenge={name:e.name,stages:[]};for(var i=Object.keys(e.stages),o=0;o<i.length;o++){let t=e.stages[i[o]];const l=t.required_questions,c=t.corect_questions,p=t.name,u=t.sets,g={name:p,required:l,corect:c,questions:[]};for(var s=Object.keys(u),a=Math.ceil(l/s.length),r=[],d=0;d<s.length;d++){var h=u[s[d]].questions;shuffleArray(h),r=r.concat(h.slice(0,a))}for(shuffleArray(r);r.length&&r.length>l;)r.pop();g.questions=r,n.challenge.stages.push(g)}}}(window,app,sharedObject),window.addEventListener("load",function(){Config.lang="en",PIXI.utils.skipHello(),App.initialize(),app.device.isLocalhost||(window.app=void 0)},!1),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screenInitialize=o.prototype.initialize,o.prototype.initialize=function(){this.screenInitialize(),this.background=new Sprite("white"),this.background.stretch(e.width,e.height),this.background.visible=!0,this.background.tint=4247011,this.addChild(this.background),this.logo=new Sprite("logo"),this.logo.scale.set(.8),this.logo.centered(),this.addChild(this.logo),this.isAnimating=!0,_loadingBar=new LoadingBar({background:"white",backgroundIsSliced:!0,backgroundWidth:600,backgroundHeight:80,backgroundPadding:"1 1 1 1",backgroundTint:747381,foreground:"white",foregroundIsSliced:!0,foregroundWidth:600,foregroundHeight:80,foregroundPadding:"1 1 1 1",foregroundTint:12252927,offsetX:0,offsetY:0,isAnimated:!1,animationSpeed:300,showPercent:!0}),this.addChild(_loadingBar),this.lastLoadedCount=0,this.setPositions()},o.prototype.setPositions=function(){var t=e.width/2,n=e.height;this.logo.position.set(t,.45*n),_loadingBar.position.set(t,.75*n),this.background.position.set(-10,-10),this.background.width=1.2*e.width,this.background.height=1.2*e.height},o.prototype.onUpdate=function(t){var e=ContentManager.countToLoad,n=ContentManager.countLoaded,i=n/e;i=i<=0?.01:i,i=0===e?1:i,n&&this.lastLoadedCount!=n&&(this.lastLoadedCount=n,_loadingBar.setPercent(i,!0))},o.prototype.onResize=function(){this.setPositions()},t.LoadingScreen=o}(window,app,sharedObject),Notes.EXAMPLE_NOTE_NAME="EXAMPLE_NOTE_NAME",function(t,e){function n(){this.initialize()}n.prototype=new Sprite,n.prototype.spriteInitialize=n.prototype.initialize,n.prototype.initialize=function(){this.spriteInitialize(),this.drawingLayer=new PIXI.Graphics,this.addChild(this.drawingLayer),this.drawingLayer.clear(),this.drawingLayer.beginFill(0),this.drawingLayer.drawRect(-50,-50,app.width+100,app.height+100);var t="rotate_device_to_portrait";Config.rotation_mode===Config.ROTATION_MODE_HORIZONTAL&&(t="rotate_device_to_landscape"),this.rotate=new Sprite(t),this.rotate.anchor.set(.5,.5),this.addChild(this.rotate),this.rotateLabel=new Label,this.rotateLabel.anchor.set(.5,.5),this.rotateLabel.txt=lang("Please rotate your device"),this.rotateLabel.style.fill="#ffffff",this.rotateLabel.style.fontSize=80,this.addChild(this.rotateLabel),this.setPositions(),this.zIndex=99999999999},n.prototype.setPositions=function(){this.rotate.position.set(app.width/2,app.height/2-100),this.rotateLabel.position.set(app.width/2,app.height/2+100)},n.prototype.onResize=function(){this.setPositions(),this.drawingLayer.clear(),this.drawingLayer.beginFill(0),this.drawingLayer.drawRect(-50,-50,app.width+100,app.height+100)},t.RotateLayer=n}(window),app.loadAssets=function(){ContentManager.addFile("challenge_completed_screen","assets/data/challenge_completed_screen.json"),ContentManager.addFile("code_screen","assets/data/code_screen.json"),ContentManager.addFile("fail_screen","assets/data/fail_screen.json"),ContentManager.addFile("game_screen","assets/data/game_screen.json"),ContentManager.addFile("header","assets/data/header.json"),ContentManager.addFile("home_screen","assets/data/home_screen.json"),ContentManager.addFile("level_completed_screen","assets/data/level_completed_screen.json"),ContentManager.addImage("_default_button","_default_button.png"),ContentManager.addImage("_default_input","_default_input@2x.png"),ContentManager.addImage("audio_off","audio_off.png"),ContentManager.addImage("audio_on","audio_on.png"),ContentManager.addImage("favicon","favicon.png"),ContentManager.addImage("hit","hit.png"),ContentManager.addImage("keyboard-key","keyboard/keyboard-key.png"),ContentManager.addImage("keyboard_backspace","keyboard/keyboard_backspace.png"),ContentManager.addImage("keyboard_capitalize","keyboard/keyboard_capitalize.png"),ContentManager.addImage("keyboard_symbols","keyboard/keyboard_symbols.png"),ContentManager.addImage("logo","logo.png"),ContentManager.addImage("mask_hole","mask_hole.png"),ContentManager.addImage("monster-1","monsters/monster-1.png"),ContentManager.addImage("monster-2","monsters/monster-2.png"),ContentManager.addImage("monster-3","monsters/monster-3.png"),ContentManager.addImage("monster-4","monsters/monster-4.png"),ContentManager.addImage("monster-5","monsters/monster-5.png"),ContentManager.addImage("monster-6","monsters/monster-6.png"),ContentManager.addImage("monster-7","monsters/monster-7.png"),ContentManager.addImage("monster-8","monsters/monster-8.png"),ContentManager.addImage("music_off","music_off.png"),ContentManager.addImage("music_on","music_on.png"),ContentManager.addImage("rounded-10","rounded/rounded-10.png"),ContentManager.addImage("rounded-15","rounded/rounded-15.png"),ContentManager.addImage("rounded-20","rounded/rounded-20.png"),ContentManager.addImage("rounded-30","rounded/rounded-30.png"),ContentManager.addImage("rounded-5","rounded/rounded-5.png"),ContentManager.addImage("star","star.png"),ContentManager.addImage("white_circle","white_circle.png"),ContentManager.addSound("boo",["assets/sounds/effects/boo.webm","assets/sounds/effects/boo.mp3"]),ContentManager.addSound("cheering",["assets/sounds/effects/cheering.webm","assets/sounds/effects/cheering.mp3"]),ContentManager.addSound("click",["assets/sounds/effects/click.webm","assets/sounds/effects/click.mp3"]),ContentManager.addSound("fail",["assets/sounds/effects/fail.webm","assets/sounds/effects/fail.mp3"]),ContentManager.addSound("monster_death_1",["assets/sounds/effects/monster_death_1.webm","assets/sounds/effects/monster_death_1.mp3"]),ContentManager.addSound("negative",["assets/sounds/effects/negative.webm","assets/sounds/effects/negative.mp3"]),ContentManager.addSound("positive-3",["assets/sounds/effects/positive-3.webm","assets/sounds/effects/positive-3.mp3"]),ContentManager.addSound("positive-4",["assets/sounds/effects/positive-4.webm","assets/sounds/effects/positive-4.mp3"]),ContentManager.addSound("yeah",["assets/sounds/effects/yeah.webm","assets/sounds/effects/yeah.mp3"]),ContentManager.addAudio("audio_full",["assets/sounds/music/audio_full.webm","assets/sounds/music/audio_full.mp3"]),ContentManager.addAudio("audio_loop",["assets/sounds/music/audio_loop.webm","assets/sounds/music/audio_loop.mp3"])},function(t,e){function n(){this.initialize()}n.prototype=new Sprite,n.prototype.spriteInitialize=n.prototype.initialize,n.prototype.initialize=function(){var t=["star"],e=t[Math.randomInt(0,t.length-1)];this.spriteInitialize(e),this.duration=900,this.total_time=0,this.emitter=null,this.direction=new V(1,1),this.trust_magnitude=0,this.begin_scale=.3,this.end_scale=.5,this.begin_alpha=1,this.end_alpha=0,this.anchor.set(.5,.5),this.reset(),this.alphaBezier=new Bezier(.67,.04,.84,.14)},n.prototype.reset=function(){this.total_time=0,this.scale.set(this.begin_scale),this.alpha=this.begin_alpha,this.direction.setAngle(Math.degreesToRadians(Math.randomInt(0,360))),this.trust_magnitude=Math.randomInt(100,800)/1e3,this.rotation=Math.degreesToRadians(Math.randomInt(0,360))},n.prototype.onUpdate=function(t){this.total_time+=t;var e=this.total_time/this.duration;if(e>1)this.emitter.recycleParticle(this);else{var n=(new V).copy(this.position);this.direction.setLength(t*this.trust_magnitude*(1-e)),n.add(this.direction),this.position.set(n.x,n.y);var i=this.begin_scale+(this.end_scale-this.begin_scale)*e,o=this.begin_alpha+(this.end_alpha-this.begin_alpha)*e;this.scale.set(i),this.alpha=o}},n.prototype.onEmmitted=function(){},t.Dust=n}(window),function(t,e){function n(){this.initialize()}n.prototype=new Sprite,n.prototype.spriteInitialize=n.prototype.initialize,n.prototype.initialize=function(){this.spriteInitialize(null),this.layer=new Sprite("white_circle"),this.layer.centered(),this.addChild(this.layer),this.centered(),this.maskLayer=new Sprite("mask_hole"),this.maskLayer.centered(),this.mask=this.maskLayer,this.addChild(this.maskLayer),this.scaling=1.5,this.duration=200,this.displace=20,this.begin=.5*this.scaling,this.end=1*this.scaling,this.pos3D={x:0,y:0,z:0},this.layer.visible=!1},n.prototype.start=function(t,e){t=t||0,this.maskLayer.position.set(Math.randomInt(-this.displace,this.displace),Math.randomInt(-this.displace,this.displace)),new Stepper(function(t){this.layer.visible=!0,this.layer.scale.set((this.begin+(this.end-this.begin)*t)*this.scaling)},this.duration,null,null,function(){},this).delay(t).run(),new Stepper(function(t){this.maskLayer.scale.set((.5+1.5*t)*this.scaling)},this.duration+200,null,null,function(){this.removeFromParent(),e&&e(this)},this).delay(t).run()},n.prototype.onUpdate=function(t){},n.prototype.setData=function(t,e,n){},n.prototype.onImport=function(t){},t.Explosion=n}(window),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screenInitialize=o.prototype.initialize,o.prototype.initialize=function(){this.screenInitialize(),this.content=new Layer,this.addChild(this.content)},o.prototype.onFxDown=function(t,e){Sounds.fx("click")},o.prototype.onMusicDown=function(t,e){Sounds.fx("click")},o.prototype.onFxUp=function(t,e){Sounds._isFXMuted=!Sounds._isFXMuted,this.setFxButtonState()},o.prototype.onMusicUp=function(t,e){Config.is_sound_on=!Config.is_sound_on,Config.is_sound_on?Sounds.audio_full.play():Sounds.audio_full.pause(),this.setButtonState()},o.prototype.setButtonState=function(){Config.is_sound_on?(this.button.imageNormal="music_on",this.button.imageSelected="music_on"):(this.button.imageNormal="music_off",this.button.imageSelected="music_off")},o.prototype.setFxButtonState=function(){Sounds._isFXMuted?(this.fxButton.imageNormal="audio_off",this.fxButton.imageSelected="audio_off"):(this.fxButton.imageNormal="audio_on",this.fxButton.imageSelected="audio_on")},o.prototype.onShow=function(){this.button=this.findById("music-button"),this.fxButton=this.findById("fx-button"),this.button.onMouseDown=this.onMusicDown.bind(this),this.button.onMouseUp=this.onMusicUp.bind(this),this.fxButton.onMouseDown=this.onFxDown.bind(this),this.fxButton.onMouseUp=this.onFxUp.bind(this),this.setButtonState(),this.setFxButtonState()},o.prototype.onHide=function(){e.input.remove(this.button),e.input.remove(this.fxButton)},t.Header=o}(window,app,sharedObject),function(t,e,n,i){function o(t){this.initialize(t)}o.prototype=new Sprite,o.prototype.spriteInitialize=o.prototype.initialize,o.prototype.initialize=function(t){this.spriteInitialize(t),this.totalHealth=0,this.health=0,this.isDead=!1,this.emitter=new Emitter(null,this.parent,Dust,.05)},o.prototype.setHealth=function(t){this.totalHealth=t,this.health=t;var e=200*t;this.healthBar=new LoadingBar({background:"white",backgroundIsSliced:!0,backgroundWidth:e,backgroundHeight:80,backgroundPadding:"1 1 1 1",backgroundTint:747381,foreground:"white",foregroundIsSliced:!0,foregroundWidth:e,foregroundHeight:80,foregroundPadding:"1 1 1 1",foregroundTint:16029470,offsetX:0,offsetY:0,isAnimated:!0,animationSpeed:6e3,showPercent:!1}),this.healthBar.setPercent(1,!1),this.healthBar.y=-this.texture.height/2,this.addChild(this.healthBar)},o.prototype.takeDamage=function(t){if(this.health-=t||1,this.healthBar.setPercent(this.health/this.totalHealth,!0),this.health<=0){for(var e=0;e<8;e++){var n=new Explosion;n.position=this.position,n.position.x+=Math.randomInt(-200,200),n.position.y+=Math.randomInt(-200,200),n.scaling=Math.randomFloat(1,1.5),this.parent.addChild(n),n.start(200*e+Math.randomInt(-100,100)),this.isDead=!0}this.tint=14694701}else new TweenBlink(this,.5,null,300).repeat(3).run();this.emitter.emissionPoint=new PIXI.Point(100,100),this.emitter.emissionPoint=this.position,this.emitter.layer=this.parent,this.emitter.start(),this.emitter.step(300),this.emitter.stop()},o.prototype.onUpdate=function(t){},o.prototype.onImport=function(){},t.Monster=o}(window,app,sharedObject),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screen_initialize=o.prototype.initialize,o.prototype.initialize=function(){this.screen_initialize(),this.setBackgroundColor("#1B6C97"),this.content=new Layer,this.addChild(this.content),this.importer=new Importer(this),this.importer.importObjects(ContentManager.jsons.challenge_completed_screen.objects,this.content)},o.prototype.onUpdate=function(t){},o.prototype.onShow=function(){},o.prototype.onHide=function(){},o.prototype.onNextChallenge=function(){Sounds.fx("click");var t=new HomeScreen;e.navigator.add(t,null,null,function(){e.navigator.setCurrentAsRoot()})},t.ChallengeCompletedScreen=o}(window,app,sharedObject),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screen_initialize=o.prototype.initialize,o.prototype.initialize=function(){this.screen_initialize(),this.setBackgroundColor("#1B6C97"),this.content=new Layer,this.addChild(this.content),this.importer=new Importer(this),this.importer.importObjects(ContentManager.jsons.code_screen.objects,this.content);var t=this.findById("code-input");t.cursor.tint=0,t.setText("qnux")},o.prototype.onEnterDown=function(){Sounds.fx("click")},o.prototype.onEnter=function(){this.checkCode()},o.prototype.checkCode=function(){var t={code:this.findById("code-input").getText()};ajaxPost("admin/api/challenge",t,function(t){if(t){n.setChallenge(t),n.progress=0;var i=new GameScreen;e.navigator.add(i)}else Toast.warrning("Challenge not found")})},o.prototype.onUpdate=function(t){},o.prototype.onShow=function(){},o.prototype.onHide=function(){},o.prototype.onKeyboardDone=function(){this.checkCode()},t.CodeScreen=o}(window,app,sharedObject),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screen_initialize=o.prototype.initialize,o.prototype.initialize=function(){this.screen_initialize(),this.setBackgroundColor("#1B6C97"),this.content=new Layer,this.addChild(this.content),this.importer=new Importer(this),this.importer.importObjects(ContentManager.jsons.fail_screen.objects,this.content)},o.prototype.onTryAgain=function(t){Sounds.fx("click"),n.progress=0;var i=new GameScreen;e.navigator.add(i,null,null,function(){e.navigator.setCurrentAsRoot()})},o.prototype.onTryOther=function(t){Sounds.fx("click"),n.progress=0;var i=new CodeScreen;e.navigator.add(i,null,null,function(){e.navigator.setCurrentAsRoot()})},o.prototype.onUpdate=function(t){},o.prototype.onShow=function(){},o.prototype.onHide=function(){},t.FailScreen=o}(window,app,sharedObject),function(t,e,n,i){function o(t,e){this.initialize(t,e)}o.prototype=new HScreen,o.prototype.screenInitialize=o.prototype.initialize,o.prototype.initialize=function(t,i){this.screenInitialize(),this.setBackgroundColor("#1B6C97"),t&&(n.setChallenge(t),n.progress=i),this.level=n.challenge.stages[n.progress],this.content=new Layer,this.addChild(this.content),this.importer=new Importer(this),this.importer.importObjects(ContentManager.jsons.game_screen.objects,this.content),this.monster=this.findById("monster"),this.questionLabel=this.findById("question-label"),this.progressLabel=this.findById("progress"),this.titleLabel=this.findById("title"),this.healthLabel=this.findById("health-label"),this.levelClearedLabel=this.findById("level-cleared"),this.levelClearedLabel.alpha=0,this.answer1=this.findById("answer-1"),this.answer2=this.findById("answer-2"),this.answer3=this.findById("answer-3"),this.answer4=this.findById("answer-4"),this.answerLabels=[this.answer1,this.answer2,this.answer3,this.answer4],this.orderedAnswerLabels=[this.answer1,this.answer2,this.answer3,this.answer4],this.answer1.label.txt="",this.answer2.label.txt="",this.answer3.label.txt="",this.answer4.label.txt="",this.monsterLayer=this.monster.parent,this.monsterPosition=(new PIXI.Point).copyFrom(this.monster.position),this.monster.removeFromParent(),this.monster=null,this.titleLabel.txt=this.level.name,this.currentQuestion=0,this.correctAnswers=0,this.wrongAnswers=0,this.totalQuestions=this.level.required,this.requiredToPass=this.level.corect,this.totalMonsters=0,this.monsters=[],this.generateMonsters(),this.loadNextQuestion(),this.loadMonster(),this.updateProgress();this.healthBar=new LoadingBar({background:"white",backgroundIsSliced:!0,backgroundWidth:500,backgroundHeight:80,backgroundPadding:"1 1 1 1",backgroundTint:747381,foreground:"white",foregroundIsSliced:!0,foregroundWidth:500,foregroundHeight:80,foregroundPadding:"1 1 1 1",foregroundTint:6868700,offsetX:0,offsetY:0,isAnimated:!0,animationSpeed:6e3,showPercent:!1}),this.healthBar.setPercent(1,!1),this.healthLabel.position.set(-e.width/2+20,e.height-110),this.healthBar.position.set(this.healthLabel.x+this.healthLabel.width+20+250,e.height-110),this.healthLabel.parent.addChild(this.healthBar),this.hit=new Sprite("hit"),this.hit.stretch(e.width,e.height),this.hit.visible=!1,this.addChild(this.hit)},o.prototype.loadMonster=function(){this.monster?this.removeMonster(()=>{timeout(()=>{this.addMonster()},200)}):this.addMonster()},o.prototype.updateProgress=function(){this.progressLabel.text="Monster "+(this.totalMonsters-this.monsters.length)+"/"+this.totalMonsters},o.prototype.removeMonster=function(t){var e=new Bezier(.64,.26,.93,.66);new TweenAlpha(this.monster,0,e,600).run(),new TweenMoveTo(this.monster,new PIXI.Point(this.monster.x,this.monster.y-100),e,200,()=>{new TweenMoveTo(this.monster,new PIXI.Point(this.monster.x,this.monster.y+600),e,400,t).run()}).run()},o.prototype.addMonster=function(){this.monster=this.monsters.pop(),this.monster.anchor.set(.5,.5),this.monster.scale.set(.4),this.monster.position.set(this.monsterPosition.x,this.monsterPosition.y),this.monsterLayer.addChild(this.monster),this.monster.alpha=0,new TweenAlpha(this.monster,1,null,200).run(),Actions.stopByTag("monster"),new TweenFloat(this.monster,10,null,1200).run("monster"),this.updateProgress()},o.prototype.generateMonsters=function(){var t=8;0===n.progress?t=3:1===n.progress?t=5:2===n.progress&&(t=7);for(var e=this.requiredToPass,i=[];e>0;){var o=Math.randomInt(1,t);e-o>=0&&(e-=o,i.push(o))}Math.bubbleSort(i,function(t,e){return t<e});for(var s=0;s<i.length;s++){var a=i[s],r=new Monster("monster-"+a);r.setHealth(a),this.monsters.push(r)}this.totalMonsters=this.monsters.length},o.prototype.loadNextQuestion=function(){let t=this.level.questions[this.currentQuestion++];for(var e=0;e<this.orderedAnswerLabels.length;e++){var n=this.orderedAnswerLabels[e];new TweenAlpha(n,1,null,300).delay(200*e).run()}if(new TweenAlpha(this.questionLabel,1,null,200).run(),t){this.questionLabel.text=t.content;var i=JSON.parse(t.answers);shuffleArray(this.answerLabels);for(e=0;e<this.answerLabels.length;e++){var o=this.answerLabels[e];o.label.text=i[e],o.tag=e}return this.disableButtons(!1),!0}return!1},o.prototype.onAnswerDown=function(t,e){Sounds.fx("click")},o.prototype.onAnswer=function(t,e){this.disableButtons(!0),0===e.tag?this.onCorrectAnswer():this.onWrongAnswer()},o.prototype.onCorrectAnswer=function(){this.correctAnswers++,new TweenShake(this,5,.5,null,100).run(),this.monster.takeDamage(),timeout(()=>{for(var t=0;t<this.orderedAnswerLabels.length;t++){var e=this.orderedAnswerLabels[t];new TweenAlpha(e,0,null,200).delay(100*t).run()}new TweenAlpha(this.questionLabel,0,null,200).run()},600);if(Sounds.fx("positive-4"),this.monster.isDead&&(Actions.stopByTag("monster"),0===this.monsters.length))return timeout(()=>{this.onLevelFinished()},2e3),void timeout(()=>{Sounds.fx("monster_death_1")},1e3);timeout(()=>{this.monster.isDead&&(Sounds.fx("monster_death_1"),this.loadMonster()),this.loadNextQuestion()||this.onLevelFinished()},1e3)},o.prototype.onWrongAnswer=function(){this.takeDamage();var t=this.totalQuestions-this.requiredToPass,e=this.wrongAnswers>=t,n=new Bezier(.31,.8,.66,.99),i=new Bezier(.76,.22,.95,.66);if(e){Sounds._isFXMuted||(Sounds.audio_full.pause(),Sounds.fail.volume(.4).once("end",function(){Config.is_sound_on&&Sounds.audio_full.fade(0,1,200).play()}).play());for(var o=0;o<this.orderedAnswerLabels.length;o++){var s=this.orderedAnswerLabels[o];let t=Math.randomInt(-100,100);new TweenMoveTo(s,{x:s.x+t,y:s.y-Math.randomInt(100,150)},n,200,function(e){new TweenMoveTo(e,{x:s.x+t,y:s.y+800},i,600).run()}).delay(100*o).run(),new TweenRotateBy(s,Math.degreesToRadians(Math.randomInt(-30,30)),null,1200).run()}new TweenAlpha(this.questionLabel,0,null,200).run(),this.onGameOver()}else Sounds.fx("negative"),timeout(()=>{for(var t=0;t<this.orderedAnswerLabels.length;t++){var e=this.orderedAnswerLabels[t];new TweenAlpha(e,0,null,200).delay(100*t).run()}new TweenAlpha(this.questionLabel,0,null,200).run()},600),timeout(()=>{this.loadNextQuestion()||this.onLevelFinished()},1e3)},o.prototype.isLevelWin=function(){return this.correctAnswers>=this.requiredToPass},o.prototype.onLevelFinished=function(){Sounds.fx("cheering"),this.onLevelCompleted()},o.prototype.onLevelCompleted=function(){this.removeMonster(),this.levelClearedLabel.alpha=1,new TweenBlink(this.levelClearedLabel,0,null,100).repeat(6).run(),timeout(()=>{if(n.challenge.stages[n.progress+1]){n.progress++;var t=new LevelCompletedScreen;e.navigator.add(t)}else{t=new ChallengeCompletedScreen;e.navigator.add(t)}},1600)},o.prototype.onGameOver=function(t){timeout(()=>{var t=new FailScreen;e.navigator.add(t)},1600)},o.prototype.onUpdate=function(t){},o.prototype.onShow=function(){},o.prototype.onHide=function(){Actions.stopByTag("monster")},o.prototype.disableButtons=function(t){for(var e=0;e<this.answerLabels.length;e++){this.answerLabels[e].isTouchable=!t}},o.prototype.takeDamage=function(){this.hit.visible=!0,this.hit.alpha=.8,new TweenAlpha(this.hit,0,new Bezier(.82,.2,.92,.62),600,()=>{this.hit.visible=!1}).run(),this.wrongAnswers++;var t=this.totalQuestions-this.requiredToPass,e=this.findByName("default");new TweenShake(e,10,.5,null,200).run();var n=1-this.wrongAnswers/t;this.healthBar.setPercent(n,!0)},t.GameScreen=o}(window,app,sharedObject),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screen_initialize=o.prototype.initialize,o.prototype.initialize=function(){this.screen_initialize(),this.setBackgroundColor("#1B6C97"),this.content=new Layer,this.addChild(this.content),this.importer=new Importer(this),this.importer.importObjects(ContentManager.jsons.home_screen.objects,this.content);this.findByTag("monster");var t=[new PIXI.filters.AlphaFilter(.5)];this.monsters=this.findById("monsters"),this.monsters.filters=t},o.prototype.onStudentDown=function(t){Sounds.fx("click")},o.prototype.onTeacherDown=function(t){Sounds.fx("click")},o.prototype.onTeacherClicked=function(e){t.open("admin")},o.prototype.onStudentClicked=function(t){Sounds.audio_full.playing()||Sounds.audio_full.loop(!0).play();var n=new CodeScreen;e.navigator.add(n)},o.prototype.onUpdate=function(t){},o.prototype.onShow=function(){},o.prototype.onHide=function(){},t.HomeScreen=o}(window,app,sharedObject),function(t,e,n,i){function o(){this.initialize()}o.prototype=new HScreen,o.prototype.screen_initialize=o.prototype.initialize,o.prototype.initialize=function(){this.screen_initialize(),this.setBackgroundColor("#1B6C97"),this.content=new Layer,this.addChild(this.content),this.importer=new Importer(this),this.importer.importObjects(ContentManager.jsons.level_completed_screen.objects,this.content)},o.prototype.onUpdate=function(t){},o.prototype.onShow=function(){},o.prototype.onHide=function(){},o.prototype.onNextLevel=function(t,n){Sounds.fx("click");var i=new GameScreen;e.navigator.add(i,null,null,function(){e.navigator.setCurrentAsRoot()})},t.LevelCompletedScreen=o}(window,app,sharedObject),Styles.addColor("transparent","transparent"),Styles.addColor("white","#ffffff"),Styles.addColor("black","#000000"),Styles.addColor("background","#cfeef0"),Styles.addColor("blue_dark","#374b63"),Styles.addColor("brown","#332c24"),Styles.addColor("gray","#939393"),Styles.addColor("green_light","#68cedc"),Styles.addColor("orange_bright","#ead3a1"),Styles.addColor("theme","#f4971e"),Styles.addColor("theme_dark","#af662f"),Styles.addColor("theme_panel","#e99630"),Styles.addButton("yellow",{dropShadowColor:"#000000",fill:"#FFFFFF",fontFamily:"sf-pro-display-regular",fontSize:30,stroke:"#341CC3"},{width:210,height:60,backgroundColorNormal:"#9DE822",textColorNormal:"#FFFFFF",_custom:[]}),Styles.addLabel("red",{dropShadowColor:"#000000",fill:"#AF662F",fontFamily:"sf-pro-display-thin",fontSize:50,stroke:"#000000"},{}),function(t,e){var n=n||function(){throw"can't initialize this class"};n.DEFAULT_INPUT={fill:"#ffffff",fontFamily:"Arial Black",fontSize:30,background:"rounded",dropShadowDistance:0},n.MULTY_LINE_LABEL={breakWords:!0,wordWrap:!0,wordWrapWidth:800,fill:"#999999",fontFamily:"Arial Black",fontSize:30,dropShadow:!0,dropShadowColor:"#000000",dropShadowDistance:1},n.DEFAULT_LABEL={fill:"#ffffff",fontFamily:"Arial Black",fontSize:50,dropShadow:!0,dropShadowColor:"#000000",dropShadowDistance:5,dropShadowBlur:10},n.DEFAULT_BUTTON={fill:"#ffffff",imageNormal:"_default_button",imageSelected:"_default_button",fontFamily:"'Arial Black', Gadget, sans-serif",fontSize:30},n.ROUNDED_BUTTON={fill:"#cccccc",imageNormal:"button",imageSelected:"button",fontFamily:"Arial Black",fontSize:30},t.Style=n}(window);